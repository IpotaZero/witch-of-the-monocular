const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./SceneTitle-D8sfcIEl.js","../run.js","./SceneGame-CrprxSQv.js"])))=>i.map(i=>d[i]);
import{S as l,P as m,_ as u,a as d,c as s,D as n}from"../run.js";import{L as a,b as y,i as f}from"./SceneTitle-D8sfcIEl.js";class p extends l{ready;#e=new m;constructor(){super(),this.ready=this.#a()}async end(){a.setCurrentBranch(this.#e.getCurrentBranch())}async#a(){this.#e.before("title",async()=>{this.#e.shaveBranch(1);const{SceneTitle:t}=await u(async()=>{const{SceneTitle:r}=await import("./SceneTitle-D8sfcIEl.js").then(e=>e.S);return{SceneTitle:r}},__vite__mapDeps([0,1]),import.meta.url);return await d.goto(()=>new t),!0}),this.#e.on("first",()=>{a.getFlags().includes("地下")||(a.addFlag("地下"),s.say("大丈夫!?","とりあえず......出口を探そうか。"))}),this.#e.on("地下通路-不",()=>{s.say("(階段から雪崩れ込んだ土砂が道を塞いでいる。)","そんな。")}),this.#e.before("祭壇",async()=>(s.say("(持ち物がひとりでに動き出し、音楽を奏で始める......。)","(近くで大きな音がした。)"),await s.wait(),a.addFlag("土砂突破"),!0)),this.#e.before("蝋燭",async()=>(a.getItems().includes("金属片")?(s.say("(金属片を温めてみると形が変わり始めた。)","(ベルを手に入れた。)"),await s.wait(),a.removeItem("金属片"),a.addItem("ベル"),this.#t()):(s.say("(青い炎が揺らめいている。)"),await s.wait()),!0)),Object.entries({大穴:["(ここから落ちてきたみたいだ。)"],格子:["(さすがに通れそうにない。)"],扉:["(開かない。)"],地下絵画:["(冒涜的なものを感じる絵。)","宗教は人だけでなく、魔女さえも狂わせたんだ。","昔の話だけどね。"],樽:["(何かの発酵したような臭いがする。)"],箒:["昔は誰でも大空を飛べたんだ。今は......どうなのかな。"]}).forEach(([t,r])=>{this.#e.before(t,async()=>(s.say(...r),await s.wait(),!0))});const i=y;i.forEach(t=>{this.#e.before("get-"+t,async()=>{this.#e.shaveBranch(1);const{SceneGame:r}=await u(async()=>{const{SceneGame:e}=await import("./SceneGame-CrprxSQv.js");return{SceneGame:e}},__vite__mapDeps([2,1,0]),import.meta.url);return await d.goto(()=>new r(t,{from:"adventure"}),{mode:"fade"}),!0})}),i.forEach(t=>{this.#e.on("clear-"+t,async r=>{a.addItem(t),this.#t(),r.back(1,{msIn:0,msOut:0}),s.say(`(${t}を手に入れた。)`)})});const o=await(await fetch("pages/adventure2.html")).text();await this.#e.load(n.container,o,{history:a.getCurrentBranch()}),this.#t()}#t(){const c=(e,h)=>n.container.querySelector(`[data-link="${e}"]`)?.classList.toggle("hidden",h),i=f;[...n.container.querySelector("#item").children].filter(e=>!e.hasAttribute("data-back")).forEach(e=>e.remove()),a.getItems().forEach(e=>{c(e,!0),n.container.querySelector("#item").innerHTML+=`<button data-link="item-${e}">${e}</button>`,this.#e.before(`item-${e}`,async()=>(s.say(i[e]??"エラー"),!0))}),a.getItems().includes("ベル")&&c("金属片",!0);const t=n.container.querySelector("[data-link=地下通路-不]"),r=n.container.querySelector("[data-link=地下通路-可");a.getFlags().includes("土砂突破")?(t.classList.add("hidden"),r.classList.remove("hidden")):(r.classList.add("hidden"),t.classList.remove("hidden")),this.#e.updateButtons(),n.container.querySelector("#update").onclick=async()=>{a.setCurrentBranch(this.#e.getCurrentBranch()),this.#a()}}}export{p as SceneAdventure};
//# sourceMappingURL=SceneAdventure2-BFznH8ES.js.map
