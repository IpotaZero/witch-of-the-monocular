const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./SceneAdventure0-D5lk_cTK.js","../run.js","./SceneAdventure1-DE-Tz5q6.js","./SceneAdventure2-CPztAPaT.js","./SceneGame-BkXgGOom.js"])))=>i.map(i=>d[i]);
import{S as E,P as A,D as y,L as r,a as u,b as d,_ as l,c as f,A as v}from"../run.js";const w=["1階のカギ","包丁","ライター","空のバケツ","鉢"],S=["ぬるついたハンマー","ヘアピン","魔導書","造花","葛"],b=["ガラス瓶","楽譜","金属片","朽ち果てたメモ","魔女"],V={"1階のカギ":"(玄関のすぐ奥の扉の鍵。......2重扉?)",包丁:"(軽くて扱いやすい包丁。)",ライター:"(よくあるライター。オイルは十分)",空のバケツ:"(何の変哲もないバケツ。)",水の入ったバケツ:"(水の入ったバケツ。地味に重い。)",鉢:"(何かが咲いていたはずの鉢。)",ぬるついたハンマー:"(油で滑って使えそうにない。)",ハンマー:"(鍵もブッ壊せそうなハンマー。)",ヘアピン:"(技術があればピッキングできそう。)",魔導書:"(物体を変質させる魔法が書いてある。)",造花:"(紙でできた紫の花。)",葛:"(日陰に追いやられている。)",ガラス瓶:"(叩くと心地よい音が鳴る。)",金属片:"(何かの成れの果て。)",楽譜:"(知らないはずなのに見るとメロディが流れてくる。)",ベル:"(少し鈍い。)",朽ち果てたメモ:"(魔女への恨み言が書かれている。)",魔女:"(ひとやしきの魔女。)"};class o{static#t=new AudioContext;static#n=this.#t.createGain();static#o=1;static#e=null;static{this.#n.connect(this.#t.destination)}#i;#s;#r=1;#c;#a=null;#l=!1;constructor(e,a){this.#i=e,this.#r=a.volume??1,this.#s=o.#t.createGain(),this.#s.gain.value=this.#r,this.#s.connect(o.#n),this.#c=this.#u(a)}async#u(e){const s=await(await fetch(this.#i)).arrayBuffer(),t=await o.#t.decodeAudioData(s);this.#a=o.#t.createBufferSource(),this.#a.buffer=t,this.#a.loopStart=e.loopStartS??0,this.#a.loopEnd=e.loopEndS??t.duration,this.#a.loop=e.loop??!0,this.#a.connect(this.#s)}async#d(e){this.#s.gain.setValueAtTime(this.#r,o.#t.currentTime),this.#s.gain.linearRampToValueAtTime(0,o.#t.currentTime+e/1e3),await new Promise(a=>setTimeout(a,e)),this.#s.disconnect(),this.#l&&this.#a?.stop(),this.#a?.disconnect()}static getPath(){return this.#e?this.#e.#i:""}static async ffp(e,a={}){await Promise.all([this.#y(1e3),this.#h(e,a)]),this.getPath()===e&&this.#m(a.when??0)}static async#h(e,a){this.#e=new o(e,a),await this.#e.#c}static#m(e){this.#e&&(this.#e.#a?.start(this.#t.currentTime+e),this.#e.#l=!0)}static setVolume(e){this.#o=e,this.#n.gain.value=this.#o}static async#y(e){this.#e&&await this.#e.#d(e)}}window.BGM=o;class p extends E{ready;#t=new A;constructor(e){super(),this.ready=this.#n(e)}async#n(e){const a=await(await fetch("pages/title.html")).text();await this.#t.load(y.container,a,{history:e}),o.ffp("assets/sounds/title.mp3"),this.#t.on("start",async()=>{if(r.isCleared){r.getClearedStageId().includes("魔女")?u.say("(あれからあの屋敷の話は聞かない。)","(核となる魔女がいなくなり、力を失ったのか。)","(屋敷で見つけたものはまだ手元にある。)","(それだけがあの日の出来事を証明するだろう。)"):(u.say("(あの屋敷には、きっとまだ囚われたものがあるのだろう。)","(あなたはもし時を戻せたら、と思った。)"),document.querySelector("[data-link=setting]").classList.add("yurayura"),document.querySelector("[data-link=delete-adventure-data]").classList.add("yurayura")),await u.wait(),this.#t.back(1);return}const t=Object.assign({"./SceneAdventure0.ts":()=>l(()=>import("./SceneAdventure0-D5lk_cTK.js"),__vite__mapDeps([0,1]),import.meta.url),"./SceneAdventure1.ts":()=>l(()=>import("./SceneAdventure1-DE-Tz5q6.js"),__vite__mapDeps([2,1]),import.meta.url),"./SceneAdventure2.ts":()=>l(()=>import("./SceneAdventure2-CPztAPaT.js"),__vite__mapDeps([3,1]),import.meta.url)}),n=`./SceneAdventure${r.getChapter()}.ts`,{SceneAdventure:c}=await t[n]();await d.goto(()=>new c,{msIn:400,msOut:800})}),this.#t.before("fullscreen",async()=>(document.fullscreenElement?document.exitFullscreen():document.body.requestFullscreen(),!0)),[...w,...S,...b].forEach(t=>{this.#t.before(t,async()=>{const{SceneGame:n}=await l(async()=>{const{SceneGame:c}=await import("./SceneGame-BkXgGOom.js");return{SceneGame:c}},__vite__mapDeps([4,1]),import.meta.url);return await d.goto(()=>new n(t,{from:"title"}),{mode:"fade"}),!0})}),this.#e(),this.#i(),this.#o(),this.#t.updateButtons()}#o(){const e=this.#t.pages.get("first");for(let s=0;s<16;s++){const t=new Image;t.src="assets/images/particle0.png",t.classList.add("particle0");const n=Math.random()**2*24;t.style.animationDelay=`${Math.random()*8}s`,t.style.width=`${n+16}vh`,t.style.animationDuration=`${Math.random()*4+8}s`,t.style.aspectRatio="1",t.style.position="absolute",t.style.left=`${10+80*(s/16)}%`,t.style.setProperty("--rotation",Math.random()>.5?"-1":"1"),e.appendChild(t)}const a=new Image;a.src="assets/images/particle1.png",this.#t.pages.getValues().forEach(s=>{s.addEventListener("click",t=>{const n=t.target.getBoundingClientRect(),c=t.clientX-n.left,_=t.clientY-n.top;for(let h=0;h<8;h++){const i=a.cloneNode();i.style.position="fixed",i.style.pointerEvents="none",i.style.left=`calc(${n.left+c}px - 4dvh)`,i.style.top=`calc(${n.top+_}px - 4dvh)`,i.style.width="8dvh",i.style.height="8dvh",i.style.scale=""+(Math.random()/2+.8),i.style.opacity=""+Math.random()*.5,i.style.transition="transform 1s ease-out, opacity 1s ease-out",i.style.zIndex="1000",document.body.appendChild(i);const m=Math.PI*2*h/8+Math.random(),g=60+Math.random()*20;requestAnimationFrame(()=>{i.style.transform=`translate(${Math.cos(m)*g/8}dvh, ${Math.sin(m)*g/8}dvh) scale(0.5) rotate(${m/Math.PI*180*(Math.random()-.5)}deg)`,i.style.opacity="0"}),setTimeout(()=>{i.remove()},1e3)}})})}#e(){const e=[...w,...S,...b],a=this.#t.pages.get("past"),s=r.getClearedStageId();e.forEach(t=>{s.includes(t)?(a.innerHTML+=`<button data-link="stage-${t}">${t}</button>`,this.#t.before(`stage-${t}`,async()=>{const{SceneGame:n}=await l(async()=>{const{SceneGame:c}=await import("./SceneGame-BkXgGOom.js");return{SceneGame:c}},__vite__mapDeps([4,1]),import.meta.url);await d.goto(()=>new n(t,{from:"title"}),{mode:"fade"})})):(a.innerHTML+=`<button data-link="stage-${t}" class="uncleared-stage">${t}</button>`,this.#t.before(`stage-${t}`,async()=>!0))})}#i(){const{bgm:e,se:a}=r.getVolume(),s=y.container.querySelector("#bgm-volume"),t=y.container.querySelector("#se-volume");s.value=""+e,t.value=""+a,o.setVolume(e/9),f.setVolume(a/9/2),s.oninput=()=>{o.setVolume(+s.value/9),r.setVolume({bgm:+s.value,se:+t.value})},t.oninput=()=>{f.setVolume(+t.value/9/2),r.setVolume({bgm:+s.value,se:+t.value})},this.#t.before("delete-adventure-data",async()=>(await v.ask(["本当に消す","消さない"])==="本当に消す"&&(r.clearAdventure(),u.say("(忘れた。)"),document.querySelector("[data-link=setting]").classList.remove("yurayura"),document.querySelector("[data-link=delete-adventure-data]").classList.remove("yurayura")),!0)),this.#t.before("delete-data",async()=>(await v.ask(["本当に消す","消さない"])==="本当に消す"&&(r.clear(),await d.goto(()=>new p)),!0))}}const $=Object.freeze(Object.defineProperty({__proto__:null,SceneTitle:p},Symbol.toStringTag,{value:"Module"}));export{o as B,$ as S,S as a,b,w as g,V as i};
//# sourceMappingURL=SceneTitle-DdCCaaRD.js.map
