const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./SceneTitle-BxgWCsaY.js","../run.js","./SceneGame-Blr9UHqg.js"])))=>i.map(i=>d[i]);
import{S as w,P as h,_ as d,a as u,c as t,A as n,D as s}from"../run.js";import{L as e}from"./SceneTitle-BxgWCsaY.js";class l extends w{ready;#t=new h;constructor(){super(),this.ready=this.#e()}async end(){e.setCurrentBranch(this.#t.getCurrentBranch())}async#e(){this.#t.before("title",async()=>{this.#t.shaveBranch(1);const{SceneTitle:a}=await d(async()=>{const{SceneTitle:i}=await import("./SceneTitle-BxgWCsaY.js").then(o=>o.S);return{SceneTitle:i}},__vite__mapDeps([0,1]),import.meta.url);return await u.goto(()=>new a),!0}),this.#t.on("first",()=>{e.getFlags().includes("2階")||(e.addFlag("2階"),t.say("私の部屋に行けば何とかなるはず。探してみて!"))}),this.#t.before("寝室",async()=>{if(e.getFlags().includes("寝室開放"))return;const a=e.getItems();if(a.includes("ヘアピン")&&a.includes("魔導書"))t.say("(魔導書に載っていた魔術でヘアピンをカギに変えて開けた。)","黒魔術の才能がありそうだねえ。"),await t.wait(),e.addFlag("寝室開放");else if(a.includes("ハンマー"))t.say("(ハンマーで鍵をブッ壊した。)","やるねえ。"),await t.wait(),e.addFlag("寝室開放");else return a.includes("ぬるついたハンマー")?(t.say("ハンマー? そんなぬるぬるじゃあ危ないよ。"),await t.wait(),!0):(t.say("(鍵がかかっている。)","壊すための道具を探すか、鍵を探すかかな。"),await t.wait(),!0)}),this.#t.on("寝室",async()=>{e.getFlags().includes("寝室")||(t.say("そこの窓から外に出られるはず。大丈夫! 下は柔らかい土だから。"),await t.wait(),e.addFlag("寝室"))}),this.#t.before("ベッド",async()=>(t.say("(黴臭いベッド。)","最近こっちに来てないから。。。"),await t.wait(),!0)),this.#t.before("ベッド下",async()=>{t.say("あーっ! 覗くな!")}),this.#t.before("窓",async()=>{t.say("(!)","(足を踏み出した瞬間突然床が抜け落ちた!)"),await t.wait(),await u.goto(()=>new l)}),this.#t.before("本棚",async()=>(t.say("(「グラフ理論入門」、「線形代数と数え上げ」、「幾何学I」......)"),await t.wait(),!0)),this.#t.before("湯舟",async()=>(e.getFlags().includes("お風呂")?(t.say("(もう入った。)"),await t.wait()):(t.say("(空っぽの湯舟。)","入る?","(入ることにした。)"),await t.wait(),await n.fadeOut(s.container,1e3),await n.fadeIn(s.container,1e3),t.say("(いい湯だった。)"),await t.wait(),e.addFlag("お風呂")),!0)),this.#t.before("おトイレ",async()=>(e.getFlags().includes("おトイレ")?(t.say("(もうした。)"),await t.wait()):(t.say("あー。一旦監視切るね。"),await t.wait(),await n.fadeOut(s.container,1e3),await n.fadeIn(s.container,1e3),t.say("おかえりっ。"),await t.wait(),e.addFlag("おトイレ")),!0)),this.#t.before("石鹸",async()=>(e.getItems().includes("ぬるついたハンマー")?(t.say("(ハンマーを洗った。)"),await t.wait(),e.removeItem("ぬるついたハンマー"),e.addItem("ハンマー"),this.#a()):(t.say("(ボディソープ等。)"),await t.wait()),!0));const r=["ぬるついたハンマー","ヘアピン","魔導書","薄い本"];r.forEach(a=>{this.#t.before("get-"+a,async()=>{this.#t.shaveBranch(1);const{SceneGame:i}=await d(async()=>{const{SceneGame:o}=await import("./SceneGame-Blr9UHqg.js");return{SceneGame:o}},__vite__mapDeps([2,1,0]),import.meta.url);return await u.goto(()=>new i(a,{from:"adventure"}),{mode:"fade"}),!0})}),r.forEach(a=>{this.#t.on("clear-"+a,async i=>{e.addItem(a),this.#a(),i.back(1,{msIn:0,msOut:0}),t.say(`(${a}を手に入れた。)`)})});const c=await(await fetch("pages/adventure1.html")).text();await this.#t.load(s.container,c,{history:e.getCurrentBranch()}),this.#a()}#a(){const r=(a,i)=>s.container.querySelector(`[data-link="${a}"]`)?.classList.toggle("hidden",i),c={"1階のカギ":"(玄関のすぐ奥の扉の鍵。......2重扉?)",包丁:"(軽くて扱いやすい包丁。)",ライター:"(よくあるライター。オイルは十分)",空のバケツ:"(何の変哲もないバケツ。)",水の入ったバケツ:"(水の入ったバケツ。地味に重い。)",ぬるついたハンマー:"(滑って使えそうにない。)",ハンマー:"(鍵もブッ壊せそうなハンマー。)",ヘアピン:"(技術があればピッキングできそう。)",魔導書:"(物体を変質させる魔法が書いてある。)",薄い本:"しばくぞ。"};[...s.container.querySelector("#item").children].filter(a=>!a.hasAttribute("data-back")).forEach(a=>a.remove()),e.getItems().forEach(a=>{r(a,!0),s.container.querySelector("#item").innerHTML+=`<button data-link="item-${a}">${a}</button>`,this.#t.before(`item-${a}`,async()=>(t.say(c[a]??"エラー"),!0))}),e.getItems().includes("ハンマー")&&r("ぬるついたハンマー",!0),this.#t.updateButtons(),s.container.querySelector("#update").onclick=async()=>{e.setCurrentBranch(this.#t.getCurrentBranch()),this.#e()}}}export{l as SceneAdventure};
//# sourceMappingURL=SceneAdventure1-CzFOA_aV.js.map
