const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./SceneAdventure0-BnDNb9Jf.js","../run.js","./SceneAdventure1-C9EcdQZ_.js","./SceneAdventure2-DX18yOc3.js","./SceneGame-DtKUkYq3.js"])))=>i.map(i=>d[i]);
import{S as I,P as E,D as g,L as c,a as u,b as m,_ as l,c as f,A as v}from"../run.js";const w=["1階のカギ","包丁","ライター","空のバケツ","鉢"],S=["ぬるついたハンマー","ヘアピン","魔導書","造花","葛"],b=["ガラス瓶","楽譜","金属片","朽ち果てたメモ","魔女"],T={"1階のカギ":"(玄関のすぐ奥の扉の鍵。......2重扉?)",包丁:"(軽くて扱いやすい包丁。)",ライター:"(よくあるライター。オイルは十分)",空のバケツ:"(何の変哲もないバケツ。)",水の入ったバケツ:"(水の入ったバケツ。地味に重い。)",鉢:"(何かが咲いていたはずの鉢。)",ぬるついたハンマー:"(油で滑って使えそうにない。)",ハンマー:"(鍵もブッ壊せそうなハンマー。)",ヘアピン:"(技術があればピッキングできそう。)",魔導書:"(物体を変質させる魔法が書いてある。)",造花:"(紙でできた紫の花。)",葛:"(日陰に追いやられている。)",ガラス瓶:"(叩くと心地よい音が鳴る。)",金属片:"(何かの成れの果て。)",楽譜:"(知らないはずなのに見るとメロディが流れてくる。)",ベル:"(少し鈍い。)",朽ち果てたメモ:"(魔女への恨み言が書かれている。)",魔女:"(ひとやしきの魔女。)"};class i{static#t=new AudioContext;static#n=this.#t.createGain();static#i=1;static#e=null;static{this.#n.connect(this.#t.destination)}#o;#s;#r=1;#c;#a=null;#l=!1;constructor(e,a){this.#o=e,this.#r=a.volume??1,this.#s=i.#t.createGain(),this.#s.gain.value=this.#r,this.#s.connect(i.#n),this.#c=this.#u(a)}async#u(e){const s=await(await fetch(this.#o)).arrayBuffer(),t=await i.#t.decodeAudioData(s);this.#a=i.#t.createBufferSource(),this.#a.buffer=t,this.#a.loopStart=e.loopStartS??0,this.#a.loopEnd=e.loopEndS??t.duration,this.#a.loop=e.loop??!0,this.#a.connect(this.#s)}async#m(e){this.#s.gain.setValueAtTime(this.#r,i.#t.currentTime),this.#s.gain.linearRampToValueAtTime(0,i.#t.currentTime+e/1e3),await new Promise(a=>setTimeout(a,e)),this.#s.disconnect(),this.#l&&this.#a?.stop(),this.#a?.disconnect()}static getPath(){return this.#e?this.#e.#o:""}static async ffp(e,a={}){await Promise.all([this.#g(1e3),this.#d(e,a)]),this.getPath()===e&&this.#h(a.when??0)}static async#d(e,a){this.#e=new i(e,a),await this.#e.#c}static#h(e){this.#e&&(this.#e.#a?.start(this.#t.currentTime+e),this.#e.#l=!0)}static setVolume(e){this.#i=e,this.#n.gain.value=this.#i}static async#g(e){this.#e&&await this.#e.#m(e)}}window.BGM=i;class y extends I{ready;#t=new E;constructor(e){super(),this.ready=this.#n(e)}async#n(e){const a=await(await fetch("pages/title.html")).text();await this.#t.load(g.container,a,{history:e}),i.ffp("assets/sounds/title.mp3"),this.#t.on("start",async()=>{if(c.isCleared){c.getClearedStageId().includes("魔女")?u.say("(あれからあの屋敷の話は聞かない。)","(核となる魔女がいなくなり、力を失ったのか。)","(屋敷で見つけたものはまだ手元にある。)","(それだけがあの日の出来事を証明するだろう。)"):(u.say("(あの屋敷には、きっとまだ囚われたものがあるのだろう。)","(あなたはもし時を戻せたら、と思った。)"),document.querySelector("[data-link=setting]").classList.add("yurayura"),document.querySelector("[data-link=delete-adventure-data]").classList.add("yurayura")),await u.wait(),this.#t.back(1);return}const t=Object.assign({"./SceneAdventure0.ts":()=>l(()=>import("./SceneAdventure0-BnDNb9Jf.js"),__vite__mapDeps([0,1]),import.meta.url),"./SceneAdventure1.ts":()=>l(()=>import("./SceneAdventure1-C9EcdQZ_.js"),__vite__mapDeps([2,1]),import.meta.url),"./SceneAdventure2.ts":()=>l(()=>import("./SceneAdventure2-DX18yOc3.js"),__vite__mapDeps([3,1]),import.meta.url)}),n=`./SceneAdventure${c.getChapter()}.ts`,{SceneAdventure:r}=await t[n]();await m.goto(()=>new r,{msIn:400,msOut:800})}),this.#t.before("fullscreen",async()=>(document.fullscreenElement?document.exitFullscreen():document.body.requestFullscreen(),!0)),[...w,...S,...b].forEach(t=>{this.#t.before(t,async()=>{const{SceneGame:n}=await l(async()=>{const{SceneGame:r}=await import("./SceneGame-DtKUkYq3.js");return{SceneGame:r}},__vite__mapDeps([4,1]),import.meta.url);return await m.goto(()=>new n(t,{from:"title"}),{mode:"fade"}),!0})}),this.#e(),this.#o(),this.#i(),this.#t.updateButtons()}#i(){const e=this.#t.pages.get("first");for(let s=0;s<16;s++){const t=new Image;t.src="assets/images/particle0.png",t.classList.add("particle0");const n=Math.random()**2*24;t.style.animationDelay=`${Math.random()*8}s`,t.style.width=`${n+16}vh`,t.style.animationDuration=`${Math.random()*4+8}s`,t.style.aspectRatio="1",t.style.position="absolute",t.style.left=`${10+80*(s/16)}%`,t.style.setProperty("--rotation",Math.random()>.5?"-1":"1"),e.appendChild(t)}const a=new Image;a.src="assets/images/particle1.png",this.#t.pages.getValues().forEach(s=>{s.addEventListener("click",t=>{const n=t.target.getBoundingClientRect(),r=t.clientX-n.left,_=t.clientY-n.top;for(let d=0;d<8;d++){const o=a.cloneNode();o.style.position="fixed",o.style.pointerEvents="none",o.style.left=`calc(${n.left+r}px - 4dvh)`,o.style.top=`calc(${n.top+_}px - 4dvh)`,o.style.width="8dvh",o.style.height="8dvh",o.style.scale=""+(Math.random()/2+.8),o.style.opacity=""+Math.random()*.5,o.style.transition="transform 1s ease-out, opacity 1s ease-out",o.style.zIndex="1000",document.body.appendChild(o);const h=Math.PI*2*d/8+Math.random(),p=60+Math.random()*20;requestAnimationFrame(()=>{o.style.transform=`translate(${Math.cos(h)*p/8}dvh, ${Math.sin(h)*p/8}dvh) scale(0.5) rotate(${h/Math.PI*180*(Math.random()-.5)}deg)`,o.style.opacity="0"}),setTimeout(()=>{o.remove()},1e3)}})})}#e(){const e=[...w,...S,...b],a=this.#t.pages.get("past"),s=c.getClearedStageId();e.forEach(t=>{s.includes(t)?(a.innerHTML+=`<button data-link="stage-${t}">${t}</button>`,this.#t.before(`stage-${t}`,async()=>{const{SceneGame:n}=await l(async()=>{const{SceneGame:r}=await import("./SceneGame-DtKUkYq3.js");return{SceneGame:r}},__vite__mapDeps([4,1]),import.meta.url);await m.goto(()=>new n(t,{from:"title"}),{mode:"fade"})})):(a.innerHTML+=`<button data-link="stage-${t}" class="uncleared-stage">${t}</button>`,this.#t.before(`stage-${t}`,async()=>!0))})}#o(){const{bgm:e,se:a}=c.getVolume(),s=g.container.querySelector("#bgm-volume"),t=g.container.querySelector("#se-volume");s.value=""+e,t.value=""+a,i.setVolume(e/9),f.setVolume(a/9/2),s.oninput=()=>{i.setVolume(+s.value/9),c.setVolume({bgm:+s.value,se:+t.value})},t.oninput=()=>{f.setVolume(+t.value/9/2),c.setVolume({bgm:+s.value,se:+t.value})},this.#t.before("delete-adventure-data",async()=>(await v.ask(["本当に消す","消さない"])==="本当に消す"&&(localStorage.removeItem("flags"),localStorage.removeItem("items"),localStorage.removeItem("chapter"),localStorage.removeItem("current-branch"),localStorage.removeItem("is-cleared"),u.say("(忘れた。)"),document.querySelector("[data-link=setting]").classList.remove("yurayura"),document.querySelector("[data-link=delete-adventure-data]").classList.remove("yurayura")),!0)),this.#t.before("delete-data",async()=>(await v.ask(["本当に消す","消さない"])==="本当に消す"&&(localStorage.clear(),await m.goto(()=>new y)),!0))}}const V=Object.freeze(Object.defineProperty({__proto__:null,SceneTitle:y},Symbol.toStringTag,{value:"Module"}));export{i as B,V as S,S as a,b,w as g,T as i};
//# sourceMappingURL=SceneTitle-BxRnIPNJ.js.map
