const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./SceneGame-CztptRF2.js","../run.js","./SceneTitle-BlLJcNsH.js","./SceneAdventure1-CyAQ-mxe.js"])))=>i.map(i=>d[i]);
import{S as h,P as l,a as t,_ as u,b as d,d as m,A as g,D as c}from"../run.js";import{L as e,B as y,g as f,i as w}from"./SceneTitle-BlLJcNsH.js";class v extends h{ready;#e=new l;constructor(){super(),this.ready=this.#a()}async end(){e.setCurrentBranch(this.#e.getCurrentBranch())}async#a(){y.ffp("assets/sounds/魔力の止水域.m4a"),this.#e.on("first",async()=>{e.getFlags().includes("あらすじ")||(e.addFlag("あらすじ"),t.say('(森の中にある洋館、通称"ひとやしき"にはある噂があった。)',"(そこには恐ろしい魔女がいて、一度入れば決して出てこられないというもの。)","(あなたは最近この辺りに引っ越してきたばかりでその噂を知らず森の中で迷い、その屋敷に入ってしまったのであった......。)","(背後の扉は閉まっている。)"),await t.wait())}),this.#e.on("room-0",()=>{e.getFlags().includes("met")||(e.addFlag("met"),t.say("(頭の中から笑い声が聞こえる。)","くすくす......","この家に入ってきちゃうなんて、君は本当に馬鹿だねえ......","まあ、君がこの家を出られるよう、手助けをしてあげよう。","私は今手が離せないから、そっちには行けないけどね。","さあ、そこの扉をくぐって......"))}),this.#e.on("room-1",()=>{e.getFlags().includes("1st")||(e.addFlag("1st"),t.say("2階から外に出る方法があるんだ。<br>まずは階段を探そう。"))}),this.#e.on("1階のカギ",a=>{t.say("そうそう、この家の物には盗難防止の魔法がかかっているから、手に入れるためには魔法を解かなくちゃいけないんだ。","すべての道具を使う必要はないかもしれないけど、見つけたものは持っていって構わないよ。","まあ百聞は一見に如かず。一緒に解いてみよう!")});const i=f;i.forEach(a=>{this.#e.before("get-"+a,async()=>{this.#e.shaveBranch(1);const{SceneGame:s}=await u(async()=>{const{SceneGame:n}=await import("./SceneGame-CztptRF2.js");return{SceneGame:n}},__vite__mapDeps([0,1,2]),import.meta.url);return await d.goto(()=>new s(a,{from:"adventure"}),{mode:"fade"}),!0})}),this.#e.before("get-1階のカギ",async a=>{this.#e.shaveBranch(1);const{SceneGame:s}=await u(async()=>{const{SceneGame:n}=await import("./SceneGame-CztptRF2.js");return{SceneGame:n}},__vite__mapDeps([0,1,2]),import.meta.url);return await d.goto(()=>new s("1階のカギ",{from:"adventure"}),{mode:"fade"}),e.getClearedStageId().includes("楽譜")?t.say("さて、ではこの魔法陣の説明をしよ......えっ知ってる? じゃあ飛ばすね。"):t.say("さて、ではこの魔法陣の説明をしよう。","各マスの中に2つ数字があるのが見えるかな?","左上の数字はそこに入るべき数字。真ん中の数字は今入っている数字だよ。","何も入っていないマスがあるのには気づいたかな?","この空白マスには線でつながった別のマスの数字をスライドさせることが出来るんだ。","線をクリックしてスライドして、すべてのマスの左上と中の数字を一致させてみよう!"),!0}),i.forEach(a=>{this.#e.on("clear-"+a,async s=>{e.addItem(a),this.#t(),s.back(1,{msIn:0,msOut:0}),t.say(`(${a}を手に入れた。)`),await m.frame(),e.setCurrentBranch(this.#e.getCurrentBranch())})}),this.#e.before("水バケツ",async()=>(e.getItems().includes("空のバケツ")?(e.removeItem("空のバケツ"),e.addItem("水の入ったバケツ"),t.say("(バケツに水を入れた。)"),this.#t()):t.say("(水は出そうだ。)"),await t.wait(),!0)),this.#e.before("room-1",async a=>e.getItems().includes("1階のカギ")?(e.getFlags().includes("key-0")||(t.say("(鍵を開けた。)"),await t.wait(),e.addFlag("key-0")),!1):(t.say("(鍵がかかっている。)","あれ、その辺りに鍵はあるかな?"),!0)),this.#e.on("階段-不",async()=>{const a=e.getItems();t.say("えぇっ!? ツタが伸びまくってるじゃん!?","何か道具を探さなくちゃね。"),await t.wait();const s=["何もしない"];a.includes("ライター")&&!a.includes("水の入ったバケツ")&&s.push("ツタを燃やす"),a.includes("ライター")&&a.includes("水の入ったバケツ")&&s.push("ツタを燃やして消火する"),a.includes("包丁")&&s.push("包丁でツタを切る");const n=await g.ask(s);n==="何もしない"?this.#e.back(1):n==="ツタを燃やす"?(t.say("ツタを燃やすの? 消火用の何かがあればいいんだけど......。"),await t.wait(),this.#e.back(1)):n==="ツタを燃やして消火する"?(e.removeItem("水の入ったバケツ"),e.addItem("空のバケツ"),e.addFlag("ツタを切った"),t.say("(ツタを燃やしてバケツの水で消火した。)"),await t.wait(),this.#s()):n==="包丁でツタを切る"&&(e.addFlag("ツタを切った"),t.say("(包丁でツタを切った。)"),await t.wait(),this.#s())}),this.#e.before("title",async()=>{this.#e.shaveBranch(1);const{SceneTitle:a}=await u(async()=>{const{SceneTitle:s}=await import("./SceneTitle-BlLJcNsH.js").then(n=>n.S);return{SceneTitle:s}},__vite__mapDeps([2,1]),import.meta.url);return await d.goto(()=>new a),!0});const o=await(await fetch("pages/adventure0.html")).text();await this.#e.load(c.container,o,{history:e.getCurrentBranch()});const r={観葉植物:["(観葉植物。)"],手が届かない:["(手が届かない。)","そこには何もないと思うよ。"],皿が入っている:["(皿が入っている。)"],絵:["(冒涜的な何かを感じる絵。)","これはね、神様だよ。","信じている人は私しかいなかったけど。"]};c.container.querySelectorAll(".serif").forEach(a=>{const s=a.getAttribute("data-link");this.#e.before(s,async()=>(t.say(...r[s]),await t.wait(),!0))}),this.#t()}async#s(){e.setChapter(1),this.#e.shaveBranch(4);const{SceneAdventure:i}=await u(async()=>{const{SceneAdventure:o}=await import("./SceneAdventure1-CyAQ-mxe.js");return{SceneAdventure:o}},__vite__mapDeps([3,1,2]),import.meta.url);d.goto(()=>new i)}#t(){const i=(r,a)=>c.container.querySelector(`[data-link="${r}"]`)?.classList.toggle("hidden",a),o=w;[...c.container.querySelector("#item").children].filter(r=>!r.hasAttribute("data-back")).forEach(r=>r.remove()),e.getItems().forEach(r=>{i(r,!0),c.container.querySelector("#item").innerHTML+=`<button data-link="item-${r}">${r}</button>`,this.#e.before(`item-${r}`,async()=>(t.say(o[r]??"エラー"),!0))}),i("空のバケツ",e.getItems().includes("空のバケツ")||e.getItems().includes("水の入ったバケツ")),i("階段-不",e.getFlags().includes("ツタを切った")),i("階段-可",!e.getFlags().includes("ツタを切った")),this.#e.updateButtons(),c.container.querySelector("#update").onclick=async()=>{e.setCurrentBranch(this.#e.getCurrentBranch()),this.#a()},this.#e.before("save",async()=>(e.setCurrentBranch(this.#e.getCurrentBranch().slice(0,-1)),t.say("(出来事を記憶に留めた。)"),!0))}}export{v as SceneAdventure};
//# sourceMappingURL=SceneAdventure0-CHyvoqCM.js.map
