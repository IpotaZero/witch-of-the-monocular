const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./SceneTitle-DCaVOL64.js","../run.js","./SceneAdventure2-BhLiE6IG.js","./SceneGame-CtHWhMcB.js"])))=>i.map(i=>d[i]);
import{S as w,P as l,_ as u,a as d,c as e,A as n,D as r}from"../run.js";import{L as a,i as h}from"./SceneTitle-DCaVOL64.js";class m extends w{ready;#e=new l;constructor(){super(),this.ready=this.#a()}async end(){a.setCurrentBranch(this.#e.getCurrentBranch())}async#a(){this.#e.before("title",async()=>{this.#e.shaveBranch(1);const{SceneTitle:t}=await u(async()=>{const{SceneTitle:s}=await import("./SceneTitle-DCaVOL64.js").then(o=>o.S);return{SceneTitle:s}},__vite__mapDeps([0,1]),import.meta.url);return await d.goto(()=>new t),!0}),this.#e.on("first",()=>{a.getFlags().includes("2階")||(a.addFlag("2階"),e.say("私の部屋に行けば何とかなるはず。探してみて!"))}),this.#e.before("寝室",async()=>{if(a.getFlags().includes("寝室開放"))return;const t=a.getItems();if(t.includes("ヘアピン")&&t.includes("魔導書"))e.say("(魔導書に載っていた魔術でヘアピンをカギに変えて開けた。)","黒魔術の才能がありそうだねえ。"),await e.wait(),a.addFlag("寝室開放");else if(t.includes("ハンマー"))e.say("(ハンマーで鍵をブッ壊した。)","やるねえ。"),await e.wait(),a.addFlag("寝室開放");else return t.includes("ぬるついたハンマー")?(e.say("ハンマー? そんなぬるぬるじゃあ危ないよ。"),await e.wait(),!0):(e.say("(鍵がかかっている。)","壊すための道具を探すか、鍵を探すかかな。"),await e.wait(),!0)}),this.#e.on("寝室",async()=>{a.getFlags().includes("寝室")||(e.say("そこの窓から外に出られるはず。大丈夫! 下は柔らかい土だから。"),await e.wait(),a.addFlag("寝室"))}),this.#e.before("ベッド",async()=>(e.say("(黴臭いベッド。)","最近こっちに来てないから。。。"),await e.wait(),!0)),this.#e.before("ベッド下",async()=>{e.say("あーっ! 覗くな!")}),this.#e.before("窓",async()=>{e.say("(!)","(足を踏み出した瞬間突然床が抜け落ちた!)"),await e.wait(),a.setChapter(2),this.#e.shaveBranch(1);const{SceneAdventure:t}=await u(async()=>{const{SceneAdventure:s}=await import("./SceneAdventure2-BhLiE6IG.js");return{SceneAdventure:s}},__vite__mapDeps([2,1,0]),import.meta.url);await d.goto(()=>new t)}),this.#e.before("本棚",async()=>(e.say("(「グラフ理論入門」、「線形代数と数え上げ」、「幾何学I」......)"),await e.wait(),!0)),this.#e.before("湯舟",async()=>(a.getFlags().includes("お風呂")?(e.say("(もう入った。)"),await e.wait()):(e.say("(空っぽの湯舟。)","入る?","(入ることにした。)"),await e.wait(),await n.fadeOut(r.container,1e3),await n.fadeIn(r.container,1e3),e.say("(いい湯だった。)"),await e.wait(),a.addFlag("お風呂")),!0)),this.#e.before("おトイレ",async()=>(a.getFlags().includes("おトイレ")?(e.say("(もうした。)"),await e.wait()):(e.say("あー。一旦監視切るね。"),await e.wait(),await n.fadeOut(r.container,1e3),await n.fadeIn(r.container,1e3),e.say("おかえりっ。"),await e.wait(),a.addFlag("おトイレ")),!0)),this.#e.before("石鹸",async()=>(a.getItems().includes("ぬるついたハンマー")?(e.say("(ハンマーを洗った。)"),await e.wait(),a.removeItem("ぬるついたハンマー"),a.addItem("ハンマー"),this.#t()):(e.say("(ボディソープ等。)"),await e.wait()),!0));const i=["ぬるついたハンマー","ヘアピン","魔導書","薄い本"];i.forEach(t=>{this.#e.before("get-"+t,async()=>{this.#e.shaveBranch(1);const{SceneGame:s}=await u(async()=>{const{SceneGame:o}=await import("./SceneGame-CtHWhMcB.js");return{SceneGame:o}},__vite__mapDeps([3,1,0]),import.meta.url);return await d.goto(()=>new s(t,{from:"adventure"}),{mode:"fade"}),!0})}),i.forEach(t=>{this.#e.on("clear-"+t,async s=>{a.addItem(t),this.#t(),s.back(1,{msIn:0,msOut:0}),e.say(`(${t}を手に入れた。)`)})});const c=await(await fetch("pages/adventure1.html")).text();await this.#e.load(r.container,c,{history:a.getCurrentBranch()}),this.#t()}#t(){const i=(t,s)=>r.container.querySelector(`[data-link="${t}"]`)?.classList.toggle("hidden",s),c=h;[...r.container.querySelector("#item").children].filter(t=>!t.hasAttribute("data-back")).forEach(t=>t.remove()),a.getItems().forEach(t=>{i(t,!0),r.container.querySelector("#item").innerHTML+=`<button data-link="item-${t}">${t}</button>`,this.#e.before(`item-${t}`,async()=>(e.say(c[t]??"エラー"),!0))}),a.getItems().includes("ハンマー")&&i("ぬるついたハンマー",!0),this.#e.updateButtons(),r.container.querySelector("#update").onclick=async()=>{a.setCurrentBranch(this.#e.getCurrentBranch()),this.#a()}}}export{m as SceneAdventure};
//# sourceMappingURL=SceneAdventure1-CRzGrK-O.js.map
