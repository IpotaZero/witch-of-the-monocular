const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./SceneTitle-DVdCZsuk.js","../run.js","./SceneAdventure2-Bcz4VgFM.js","./SceneGame-WW1LIIrD.js"])))=>i.map(i=>d[i]);
import{S as w,P as l,_ as o,b as d,a as t,A as h,d as c,D as i}from"../run.js";import{L as a,B as y,a as f,i as g}from"./SceneTitle-DVdCZsuk.js";class b extends w{ready;#t=new l;constructor(){super(),this.ready=this.#a()}async end(){a.setCurrentBranch(this.#t.getCurrentBranch())}async#a(){y.ffp("assets/sounds/魔力の止水域.m4a"),this.#t.before("title",async()=>{this.#t.shaveBranch(1);const{SceneTitle:e}=await o(async()=>{const{SceneTitle:s}=await import("./SceneTitle-DVdCZsuk.js").then(r=>r.S);return{SceneTitle:s}},__vite__mapDeps([0,1]),import.meta.url);return await d.goto(()=>new e),!0}),this.#t.on("first",()=>{a.getFlags().includes("2階")||(a.addFlag("2階"),t.say("私の部屋に行けば何とかなるはず。探してみて!"))}),this.#t.before("寝室",async()=>{if(a.getFlags().includes("寝室開放"))return;const e=a.getItems();t.say("(鍵がかかっている。)","壊すための道具を探すか、鍵を探すかかな。"),await t.wait();const s=["何もしない"];e.includes("ヘアピン")&&!e.includes("魔導書")&&s.push("ヘアピンでピッキングする"),e.includes("ヘアピン")&&e.includes("魔導書")&&s.push("ヘアピンを変質させる"),e.includes("ぬるついたハンマー")&&s.push("ハンマーでカギを壊す"),e.includes("ハンマー")&&s.push("ハンマーでカギを壊す");const r=await h.ask(s);if(r==="何もしない")return!0;if(r==="ヘアピンでピッキングする")return t.say("(ピッキングを試みた。)","(......失敗した。)"),await t.wait(),!0;if(r==="ヘアピンを変質させる")t.say("(魔導書に載っていた魔術でヘアピンをカギに変えて開けた。)","黒魔術の才能がありそうだねえ。"),await t.wait(),a.addFlag("寝室開放");else if(r==="ハンマーでカギを壊す")if(e.includes("ハンマー"))t.say("(ハンマーで鍵をブッ壊した。)","やるねえ。"),await t.wait(),a.addFlag("寝室開放");else return t.say("ハンマー? そんなぬるぬるじゃあ危ないよ。"),await t.wait(),!0}),this.#t.on("寝室",async()=>{a.getFlags().includes("寝室")||(t.say("そこの窓から外に出られるはず。大丈夫! 下は柔らかい土だから。"),await t.wait(),a.addFlag("寝室"))}),this.#t.before("ベッド",async()=>(t.say("(黴臭いベッド。)","最近こっちに来てないから。。。"),await t.wait(),!0)),this.#t.before("ベッド下",async()=>{t.say("あーっ! 覗くな!")}),this.#t.before("窓",async()=>{if(await h.ask(["窓から飛び降りる","飛び降りない"])==="飛び降りない")return!0;t.say("(!)","(足を踏み出した瞬間突然床が抜け落ちた!)"),await t.wait(),a.setChapter(2),this.#t.shaveBranch(1);const{SceneAdventure:s}=await o(async()=>{const{SceneAdventure:r}=await import("./SceneAdventure2-Bcz4VgFM.js");return{SceneAdventure:r}},__vite__mapDeps([2,1,0]),import.meta.url);await d.goto(()=>new s)}),this.#t.before("本棚",async()=>(t.say("(「グラフ理論入門」、「線形代数と数え上げ」、「幾何学I」......)"),await t.wait(),!0)),this.#t.before("本棚-左",async()=>(t.say("(「〇〇地方の土着信仰」、「異端」)"),await t.wait(),!0)),this.#t.before("湯舟",async()=>(a.getFlags().includes("お風呂")?(t.say("(もう入った。)"),await t.wait()):(t.say("(お湯が張ってある)","入る?","(入ることにした。)"),await t.wait(),await c.fadeOut(i.container,1e3),await c.fadeIn(i.container,1e3),t.say("(いい湯だった。)"),await t.wait(),a.addFlag("お風呂")),!0)),this.#t.before("おトイレ",async()=>(a.getFlags().includes("おトイレ")?(t.say("(もうした。)"),await t.wait()):(t.say("あー。ごゆっくり。"),await t.wait(),await c.fadeOut(i.container,1e3),await c.fadeIn(i.container,1e3),t.say("おかえりっ。"),await t.wait(),a.addFlag("おトイレ")),!0)),this.#t.before("石鹸",async()=>(a.getItems().includes("ぬるついたハンマー")?(t.say("(ハンマーを洗った。)"),await t.wait(),a.removeItem("ぬるついたハンマー"),a.addItem("ハンマー"),this.#e()):(t.say("(ボディソープ等。)"),await t.wait()),!0));const n=f;n.forEach(e=>{this.#t.before("get-"+e,async()=>{this.#t.shaveBranch(1);const{SceneGame:s}=await o(async()=>{const{SceneGame:r}=await import("./SceneGame-WW1LIIrD.js");return{SceneGame:r}},__vite__mapDeps([3,1,0]),import.meta.url);return await d.goto(()=>new s(e,{from:"adventure"}),{mode:"fade"}),!0})}),n.forEach(e=>{this.#t.on("clear-"+e,async s=>{a.addItem(e),this.#e(),s.back(1,{msIn:0,msOut:0}),t.say(`(${e}を手に入れた。)`),a.setCurrentBranch(this.#t.getCurrentBranch())})});const u=await(await fetch("pages/adventure1.html")).text();await this.#t.load(i.container,u,{history:a.getCurrentBranch()}),this.#e()}#e(){const n=(e,s)=>i.container.querySelector(`[data-link="${e}"]`)?.classList.toggle("hidden",s),u=g;[...i.container.querySelector("#item").children].filter(e=>!e.hasAttribute("data-back")).forEach(e=>e.remove()),a.getItems().forEach(e=>{n(e,!0),i.container.querySelector("#item").innerHTML+=`<button data-link="item-${e}">${e}</button>`,this.#t.before(`item-${e}`,async()=>(t.say(u[e]??"エラー"),!0))}),a.getItems().includes("ハンマー")&&n("ぬるついたハンマー",!0),this.#t.updateButtons(),i.container.querySelector("#update").onclick=async()=>{a.setCurrentBranch(this.#t.getCurrentBranch()),this.#a()},this.#t.before("save",async()=>(a.setCurrentBranch(this.#t.getCurrentBranch().slice(0,-1)),t.say("(出来事を記憶に留めた。)"),!0))}}export{b as SceneAdventure};
//# sourceMappingURL=SceneAdventure1-C6NVCSBM.js.map
