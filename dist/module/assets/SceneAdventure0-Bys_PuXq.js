const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./SceneGame-Blr9UHqg.js","../run.js","./SceneTitle-BxgWCsaY.js","./SceneAdventure1-CzFOA_aV.js"])))=>i.map(i=>d[i]);
import{S as l,P as h,c as t,_ as u,a as d,D as i}from"../run.js";import{L as e}from"./SceneTitle-BxgWCsaY.js";class f extends l{ready;#e=new h;constructor(){super(),this.ready=this.#t()}async end(){e.setCurrentBranch(this.#e.getCurrentBranch())}async#t(){this.#e.on("first",async()=>{e.getFlags().includes("あらすじ")||(e.addFlag("あらすじ"),t.say('(森の中にある洋館、通称"ひとやしき"にはある噂があった。)',"(そこには恐ろしい魔女がいて、一度入れば決して出てこられないというもの。)","(あなたは最近この辺りに引っ越してきたばかりでその噂を知らず、森の中で迷った挙句その屋敷に入ってしまったのであった......。)"),await t.wait())}),this.#e.on("room-0",()=>{e.getFlags().includes("met")||(e.addFlag("met"),t.say("(頭の中から笑い声が聞こえる。)","くすくす......","この家に入ってきちゃうなんて、君は本当に馬鹿だねえ......","とはいえ鍵をかけてなかった私も悪い。","よって、君がこの家を出られるよう、手助けをしてあげよう。","私は今手が離せないから、そっちには行けないけどね。","さあ、そこの扉をくぐって......"))}),this.#e.on("room-1",()=>{e.getFlags().includes("1st")||(e.addFlag("1st"),t.say("2階から外に出る方法があるんだ。<br>まずは階段を探そう。"))}),this.#e.on("1階のカギ",a=>{t.say("そうそう、この家の物には盗難防止の魔法がかかっているから、手に入れるためには魔法を解かなくちゃいけないんだ。","すべての道具を使う必要はないかもしれないけど、見つけたものは持っていって構わないよ。","まあ百聞は一見に如かず。一緒に解いてみよう!")});const n=["1階のカギ","包丁","ライター","空のバケツ"];n.forEach(a=>{this.#e.before("get-"+a,async()=>{this.#e.shaveBranch(1);const{SceneGame:r}=await u(async()=>{const{SceneGame:o}=await import("./SceneGame-Blr9UHqg.js");return{SceneGame:o}},__vite__mapDeps([0,1,2]),import.meta.url);return await d.goto(()=>new r(a,{from:"adventure"}),{mode:"fade"}),!0})}),this.#e.before("get-1階のカギ",async a=>{this.#e.shaveBranch(1);const{SceneGame:r}=await u(async()=>{const{SceneGame:o}=await import("./SceneGame-Blr9UHqg.js");return{SceneGame:o}},__vite__mapDeps([0,1,2]),import.meta.url);return await d.goto(()=>new r("1階のカギ",{from:"adventure"}),{mode:"fade"}),t.say("さて、ではこの魔法陣の説明をしよう。","各マスの中に2つ数字があるのが見えるかな?","左上の数字はそこに入るべき数字。真ん中の数字は今入っている数字だよ。","何も入っていないマスがあるのには気づいたかな?","この空白マスには線でつながった別のマスの数字をスライドさせることが出来るんだ。","線をクリックしてスライドして、すべてのマスの左上と中の数字を一致させてみよう!"),!0}),n.forEach(a=>{this.#e.on("clear-"+a,async r=>{e.addItem(a),this.#s(),r.back(1,{msIn:0,msOut:0}),t.say(`(${a}を手に入れた。)`)})}),this.#e.before(".*",async()=>{t.hide()}),this.#e.before("水バケツ",async()=>(e.getItems().includes("空のバケツ")?(e.removeItem("空のバケツ"),e.addItem("水の入ったバケツ"),t.say("(バケツに水を入れた。)")):t.say("(水は出そうだ。)"),await t.wait(),!0)),this.#e.before("room-1",async a=>e.getItems().includes("1階のカギ")?(e.getFlags().includes("key-0")||(t.say("(鍵を開けた。)"),await t.wait(),e.addFlag("key-0")),!1):(t.say("(鍵がかかっている。)","あれ、その辺りに鍵はあるかな?"),!0)),this.#e.on("階段-不",async()=>{const a=e.getItems();a.includes("ライター")&&a.includes("水の入ったバケツ")?(t.say("(ツタを燃やしてバケツの水で消火した。)"),e.removeItem("水の入ったバケツ"),e.addItem("空のバケツ"),e.addFlag("ツタを切った"),await t.wait(),this.#a()):a.includes("包丁")?(t.say("(包丁でツタを切った。)"),e.addFlag("ツタを切った"),await t.wait(),this.#a()):a.includes("ライター")?(t.say("ツタを燃やすの? 消火用の何かがあればいいんだけど......。"),await t.wait()):t.say("えぇっ!? ツタが伸びまくってるじゃん!?","何か道具を探さなくちゃね。")}),this.#e.before("title",async()=>{this.#e.shaveBranch(1);const{SceneTitle:a}=await u(async()=>{const{SceneTitle:r}=await import("./SceneTitle-BxgWCsaY.js").then(o=>o.S);return{SceneTitle:r}},__vite__mapDeps([2,1]),import.meta.url);return await d.goto(()=>new a),!0});const c=await(await fetch("pages/adventure0.html")).text();await this.#e.load(i.container,c,{history:e.getCurrentBranch()});const s={観葉植物:["(観葉植物。)","日当たりが悪くてげっそりしてるけど、世話はしてるよ。"],手が届かない:["(手が届かない。)","そこには何もないと思うよ。"],皿が入っている:["(皿が入っている。)"],絵:["(冒涜的な何かを感じる絵。)","これはね、神様だよ。"]};i.container.querySelectorAll(".serif").forEach(a=>{const r=a.getAttribute("data-link");this.#e.before(r,async()=>(t.say(...s[r]),await t.wait(),!0))}),this.#s()}async#a(){e.setChapter(1),this.#e.shaveBranch(4);const{SceneAdventure:n}=await u(async()=>{const{SceneAdventure:c}=await import("./SceneAdventure1-CzFOA_aV.js");return{SceneAdventure:c}},__vite__mapDeps([3,1,2]),import.meta.url);d.goto(()=>new n)}#s(){const n=(s,a)=>i.container.querySelector(`[data-link="${s}"]`)?.classList.toggle("hidden",a),c={"1階のカギ":"(玄関のすぐ奥の扉の鍵。......2重扉?)",包丁:"(軽くて扱いやすい包丁。)",ライター:"(よくあるライター。オイルは十分)",空のバケツ:"(何の変哲もないバケツ。)",水の入ったバケツ:"(水の入ったバケツ。地味に重い。)"};[...i.container.querySelector("#item").children].filter(s=>!s.hasAttribute("data-back")).forEach(s=>s.remove()),e.getItems().forEach(s=>{n(s,!0),i.container.querySelector("#item").innerHTML+=`<button data-link="item-${s}">${s}</button>`,this.#e.before(`item-${s}`,async()=>(t.say(c[s]??"エラー"),!0))}),n("空のバケツ",e.getItems().includes("空のバケツ")||e.getItems().includes("水の入ったバケツ")),n("階段-不",e.getFlags().includes("ツタを切った")),n("階段-可",!e.getFlags().includes("ツタを切った")),this.#e.updateButtons(),i.container.querySelector("#update").onclick=async()=>{e.setCurrentBranch(this.#e.getCurrentBranch()),this.#t()}}}export{f as SceneAdventure};
//# sourceMappingURL=SceneAdventure0-Bys_PuXq.js.map
